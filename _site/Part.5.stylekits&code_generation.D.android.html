<!DOCTYPE html>
<!--
    So Simple Jekyll Theme 3.1.3
    Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/so-simple-theme/blob/master/LICENSE
-->
<html lang="en-US" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  

  
    <title>Android</title>
    <meta name="description" content="">
    <link rel="canonical" href="http://localhost:4000/Part.5.stylekits&code_generation.D.android.html">
  

  <script>
    /* Cut the mustard */
    if ( 'querySelector' in document && 'addEventListener' in window ) {
      document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + 'js';
    }
  </script>

  <link rel="stylesheet" href="/assets/css/main.css">
  <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

</head>


  <body class="layout--page  android">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

    <header class="masthead">
  <div class="wrap">
    
    
    
      
        <div class="site-title animated fadeIn"><a href="/">paintcode-documents-in-chinese</a></div>
      
      <p class="site-description animated fadeIn" itemprop="description"></p>
    
  </div>
</header><!-- /.masthead -->


    <main id="main" class="main-content" aria-label="Content">
  <article>
    

    <div class="page-wrapper">
      <header class="page-header">
        
        
          <h1 id="page-title" class="page-title">Android</h1>
        
      </header>
      <div class="page-content">
        <h1 id="android"><a href="/_cover.html">Android</a></h1>

<p>PaintCode 可以生成在 Android 应用开发中使用的绘图代码。</p>

<p><a href="https://youtu.be/fYpTCR7uW14">▶️PaintCode 安卓代码导出</a></p>

<p>PaintCode 在指定的画布里 生成使用 <a href="https://developer.android.com/reference/android/graphics/package-summary.html">android.graphics API</a> 来绘制 2D 图像的方法（android.graphics.Canvas）。</p>

<p>以这个房子图标为例：</p>

<p><img src="/images/drawing.png" alt="绘图" /></p>

<p>将生成以下代码：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void drawHouseIcon<span class="o">(</span>Canvas canvas<span class="o">)</span> <span class="o">{</span>
    // General Declarations
    Paint paint<span class="p">;</span>
    // Local Colors
    int houseIconColor <span class="o">=</span> Color.argb<span class="o">(</span>255, 0, 149, 233<span class="o">)</span><span class="p">;</span>
    // Bezier
    RectF bezierRect <span class="o">=</span> new RectF<span class="o">(</span>2f, 1.5f, 28f, 28f<span class="o">)</span><span class="p">;</span>
    Path bezierPath <span class="o">=</span> new Path<span class="o">()</span><span class="p">;</span>
    bezierPath.moveTo<span class="o">(</span>18f, 18f<span class="o">)</span><span class="p">;</span>
    bezierPath.lineTo<span class="o">(</span>12f, 18f<span class="o">)</span><span class="p">;</span>
    ...
    bezierPath.lineTo<span class="o">(</span>21f, 8f<span class="o">)</span><span class="p">;</span>
    bezierPath.close<span class="o">()</span><span class="p">;</span>
    paint <span class="o">=</span> new Paint<span class="o">()</span><span class="p">;</span>
    paint.setStyle<span class="o">(</span>Paint.Style.FILL<span class="o">)</span><span class="p">;</span>
    paint.setColor<span class="o">(</span>houseIconColor<span class="o">)</span><span class="p">;</span>
    canvas.drawPath<span class="o">(</span>bezierPath, paint<span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>这个在各种情况下都很有用。其中之一是实现 View 类的自定义子类。为了使自定义视图绘制房子图标，你可以将该方法粘贴到新的 View 子类中，然后像下面这样重写 <code class="highlighter-rouge">onDraw</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Override
protected void onDraw<span class="o">(</span>Canvas canvas<span class="o">)</span> <span class="o">{</span>
    super.onDraw<span class="o">(</span>canvas<span class="o">)</span><span class="p">;</span>
    drawHouseIcon<span class="o">(</span>canvas<span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="stylekit">StyleKit</h2>

<p>在小型试验中，将代码从 PaintCode 复制粘贴到你的 Android 项目里是没问题的，但实际上效果并不是很好。 对于任何需要在设计和实现之间快速周转的项目，建议使用另一种方法。</p>

<p>PaintCode 生成特殊的 Java 类，我们叫它 StyleKit。它包含了所有的绘方法（有些是多种形式的），还包含了颜色、阴影、渐变和图片的集合，你可以在你的 Android 项目中使用这些方法。</p>

<p>在你第一次切换到 StyleKit 标签时，你需要在检查器中填写名字和包名：</p>

<p><img src="/images/inspector_android.png" alt="检查器" /></p>

<p>包名会被用在类的头部，同时它还会指定类保存到你的安卓项目中的正确文件夹。将设你的 StyleKit 名字是 HouseStyleKit，然后你的包名是 <code class="highlighter-rouge">com.example.house_package</code>。</p>

<p>点击导出然后设置主要源目录。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Android Project&gt;/app/src/main
</code></pre></div></div>

<p>PaintCode 会自动给包创建文件夹结构，因为它会将你的类保存为：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Android Project&gt;/app/src/main/com/example/house_package/HouseStyleKit.java
</code></pre></div></div>

<p>如果你的 StyleKit 使用了位图，那么它们也会被根据它们的像素密度导出到文件夹里。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Android Project&gt;/app/src/main/res/drawable-mdpi
&lt;Android Project&gt;/app/src/main/res/drawable-xhdpi
&lt;Android Project&gt;/app/src/main/res/drawable-xxhdpi
</code></pre></div></div>

<p>注意：你只需要选择正确的路径一次。在这之后，每当你再次导出，你的类和位图都会被更新。这也是为什么你不应该手动修改生成的资源。每次导出时，你的更改都会丢失。</p>

<p>StyleKit 使得每次集成只需要几秒钟。在每次修改 PaintCode 文件后，你只需要在 PaintCode 里 按 <code class="highlighter-rouge">⌘R</code>，然后在 Android Studio 中按 <code class="highlighter-rouge">⌘R</code>，就可以在测试设备上看到设计的更新。</p>

<p>对前一个使用示例的唯一更改是 <code class="highlighter-rouge">drawHouseIcon</code> 方法的位置。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Override
protected void onDraw<span class="o">(</span>Canvas canvas<span class="o">)</span> <span class="o">{</span>
    super.onDraw<span class="o">(</span>canvas<span class="o">)</span><span class="p">;</span>
    HouseStyleKit.drawHouseIcon<span class="o">(</span>canvas<span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="参数化绘图">参数化绘图</h2>

<p>当你的绘图是参数化的时（使用了变量、Frame、参数颜色等），方法签名里包含越多属性，包含的参数就越多。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public void drawHouseIcon<span class="o">(</span>Canvas canvas, int iconColor<span class="o">)</span> <span class="o">{</span>
   ...
<span class="o">}</span>
</code></pre></div></div>

<h2 id="带属性的自定义视图">带属性的自定义视图</h2>

<p>自定义视图可以被改进，以便在布局中修改它的属性。如果自定义视图被成为 <code class="highlighter-rouge">HouseView</code>，下面的文件必须进行编辑：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Android Project&gt;/app/src/main/res/values/attrs_house_view.xml
</code></pre></div></div>

<p>包含一个属性(让我们称之为 fillColor) :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;resources&gt;
    &lt;declare-styleable <span class="nv">name</span><span class="o">=</span><span class="s2">"HouseView"</span><span class="o">&gt;</span>
        &lt;attr <span class="nv">name</span><span class="o">=</span><span class="s2">"fillColor"</span> <span class="nv">format</span><span class="o">=</span><span class="s2">"color"</span> /&gt;
    &lt;/declare-styleable&gt;
&lt;/resources&gt;
</code></pre></div></div>

<p>最后，必须更新自定义适度的实现，以便在初始化期间家在属性：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class HouseView extends View <span class="o">{</span>
    private int mFillColor <span class="o">=</span> Color.RED<span class="p">;</span>

    public HouseView<span class="o">(</span>Context context<span class="o">)</span> <span class="o">{</span>
        super<span class="o">(</span>context<span class="o">)</span><span class="p">;</span>
        init<span class="o">(</span>null, 0<span class="o">)</span><span class="p">;</span>
    <span class="o">}</span>

    public HouseView<span class="o">(</span>Context context, AttributeSet attrs<span class="o">)</span> <span class="o">{</span>
        super<span class="o">(</span>context, attrs<span class="o">)</span><span class="p">;</span>
        init<span class="o">(</span>attrs, 0<span class="o">)</span><span class="p">;</span>
    <span class="o">}</span>

    public HouseView<span class="o">(</span>Context context, AttributeSet attrs, int defStyle<span class="o">)</span> <span class="o">{</span>
        super<span class="o">(</span>context, attrs, defStyle<span class="o">)</span><span class="p">;</span>
        init<span class="o">(</span>attrs, defStyle<span class="o">)</span><span class="p">;</span>
    <span class="o">}</span>

    private void init<span class="o">(</span>AttributeSet attrs, int defStyle<span class="o">)</span> <span class="o">{</span>
        // Load attributes
        final TypedArray a <span class="o">=</span> getContext<span class="o">()</span>.obtainStyledAttributes<span class="o">(</span>
                attrs, R.styleable.HouseView, defStyle, 0<span class="o">)</span><span class="p">;</span>

        mFillColor <span class="o">=</span> a.getColor<span class="o">(</span>
                R.styleable.HouseView_fillColor,
                mFillColor<span class="o">)</span><span class="p">;</span>

        a.recycle<span class="o">()</span><span class="p">;</span>
    <span class="o">}</span>
    ...
<span class="o">}</span>
</code></pre></div></div>

<p>从现在开始，自定义视图有了新的属性 <code class="highlighter-rouge">fillColor</code>，可以像下面那样用于布局：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    &lt;view
        <span class="nv">class</span><span class="o">=</span><span class="s2">"com.pixelcut.houseproject.HouseView"</span>
        android:id<span class="o">=</span><span class="s2">"@+id/view"</span>
        app:fillColor<span class="o">=</span><span class="s2">"@color/colorPrimary"</span>
        android:layout_width<span class="o">=</span><span class="s2">"wrap_content"</span>
        android:layout_height<span class="o">=</span><span class="s2">"wrap_content"</span> /&gt;
</code></pre></div></div>

<p>也可以在设计标签中找到：</p>

<p><img src="/images/fill_color.png" alt="颜色填充" /></p>

<h2 id="层类型">层类型</h2>

<p>默认情况下，视图使用硬件层类型。在某些情况下这个类型啃根更快，但它不支持模糊（在阴影中使用）和缩放。所以为了为了使渲染更加准确，你需要将 layerType 属性改为 software。</p>

<h2 id="context">Context</h2>

<p>如果你使用了位图和自定义字体，StyleKit 需要引用这些文件。在这两种情况里，它都需要一个 <code class="highlighter-rouge">context</code> 类实例。你需要设置名为 <code class="highlighter-rouge">context</code> 的静态属性来提供。例如，在活动的初始化时：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Override
protected void onCreate<span class="o">(</span>Bundle savedInstanceState<span class="o">)</span> <span class="o">{</span>
    super.onCreate<span class="o">(</span>savedInstanceState<span class="o">)</span><span class="p">;</span>
    setContentView<span class="o">(</span>R.layout.activity_main<span class="o">)</span><span class="p">;</span>
    HouseStyleKit.context <span class="o">=</span> getApplicationContext<span class="o">()</span><span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="scale">Scale</h2>

<p>有两种缩放的方法。你可以使用 <code class="highlighter-rouge">resizing drawing methods</code>。绘方法的缩放变体是同样的绘方法，但是它还有两个参数：目标矩形（类似为 RectF）和缩放行为。<code class="highlighter-rouge">ResizingBehavior</code> 是StyleKit中定义的枚举类型。这些值是：</p>

<ul>
  <li>AspectFit</li>
  <li>AspectFill</li>
  <li>Center</li>
  <li>Stretch</li>
</ul>

<p>这是在参数化 drawHouseIcon 方法中使用这种方法的一个例子:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HouseStyleKit.drawHouseIcon<span class="o">(</span>canvas,
    targetRectangle,
    HouseStyleKit.ResizingBehavior.AspectFit,
    Color.BLUE<span class="o">)</span><span class="p">;</span>
</code></pre></div></div>

<p>如果你只是想考虑设备的显示像素密度，你可以在调用 drawing 方法之前缩放画布：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Override
protected void onDraw<span class="o">(</span>Canvas canvas<span class="o">)</span> <span class="o">{</span>
    super.onDraw<span class="o">(</span>canvas<span class="o">)</span><span class="p">;</span>

    float displayDensity <span class="o">=</span> getResources<span class="o">()</span>.getDisplayMetrics<span class="o">()</span>.density<span class="p">;</span>
    canvas.scale<span class="o">(</span>displayDensity, displayDensity<span class="o">)</span><span class="p">;</span>

    HouseStyleKit.drawHouseIcon<span class="o">(</span>canvas<span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="vector-drawables">Vector drawables</h2>

<p><code class="highlighter-rouge">Vector drawables</code> 被认为是类似于 SVG 的图片。请参阅 图片导出 部分。</p>


        
      </div>
    </div>
  </article>
</main>


    <footer id="footer" class="site-footer">
  <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
<div class="copyright">
    
      <p>&copy; 2019 paintcode-documents-in-chinese. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/mmistakes/so-simple-theme" rel="nofollow">So Simple</a>.</p>
    
  </div>
</footer>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>


  </body>

</html>
