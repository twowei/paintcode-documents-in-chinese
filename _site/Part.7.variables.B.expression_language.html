<!DOCTYPE html>
<!--
    So Simple Jekyll Theme 3.1.3
    Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/so-simple-theme/blob/master/LICENSE
-->
<html lang="en-US" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  

  
    <title>表达式语言</title>
    <meta name="description" content="">
    <link rel="canonical" href="http://localhost:4000/Part.7.variables.B.expression_language.html">
  

  <script>
    /* Cut the mustard */
    if ( 'querySelector' in document && 'addEventListener' in window ) {
      document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + 'js';
    }
  </script>

  <link rel="stylesheet" href="/assets/css/main.css">
  <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

</head>


  <body class="layout--page  表达式语言">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

    <header class="masthead">
  <div class="wrap">
    
    
    
      
        <div class="site-title animated fadeIn"><a href="/">paintcode-documents-in-chinese</a></div>
      
      <p class="site-description animated fadeIn" itemprop="description"></p>
    
  </div>
</header><!-- /.masthead -->


    <main id="main" class="main-content" aria-label="Content">
  <article>
    

    <div class="page-wrapper">
      <header class="page-header">
        
        
          <h1 id="page-title" class="page-title">表达式语言</h1>
        
      </header>
      <div class="page-content">
        <h1 id="表达式语言"><a href="/_cover.html">表达式语言</a></h1>

<p>在 PaintCode 里，你可以使用我们简单的表达式语言来定义依赖于其它变量的变量。它支持许多的数学计算、逻辑函数和许多程序员期待的运算符。它的语法是 <code class="highlighter-rouge">C</code> 和 <code class="highlighter-rouge">JavaScript</code> 的子集，非常简单。</p>

<p><a href="https://youtu.be/Shu5gqfJOWw">▶️变量和表达式</a></p>

<p>只需要创建一个类型为 <code class="highlighter-rouge">'expression'</code> 的新变量，并将表达式写入文本框。新变量的值会被自动计算和更新。</p>

<p>在你导出了 PaintCode 文档后，这些变量表达式会被转换成你所选择的编程语言（Objective-C，Swift，C#，JavaScript 和 Java）。它们定义的变量之间的计算和动态关系在导出的代码里会继续起作用。</p>

<h2 id="变量类型">变量类型</h2>

<h3 id="numbers">Numbers</h3>

<p>PaintCode 中所有的数字都是浮点型。以下的表达式会返回数字：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5 <span class="k">*</span> 4 + 3 <span class="k">*</span> 2
</code></pre></div></div>

<p>你可以轻松地在表达式里引用其他变量。这个语言还有一些内置的函数可以调用：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>width <span class="k">*</span> <span class="o">(</span>4 - offset<span class="o">)</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sin<span class="o">(</span>2.7 / PI <span class="k">*</span> 180<span class="o">)</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqrt<span class="o">(</span>width <span class="k">*</span> width + heigt <span class="k">*</span> height<span class="o">)</span>
</code></pre></div></div>

<h3 id="texts">Texts</h3>

<p>文本变量是无限长度的字符串。你可以使用单引号或者双引号作为文本限定符：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"This is text!"</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'This is also text, now using single quotes.'</span>
</code></pre></div></div>

<p>文本可以使用 <code class="highlighter-rouge">'+'</code> 运算符串联。数字也可以通过使用 <code class="highlighter-rouge">stringFromNumber(x)</code> 函数转为文本。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"angle: "</span> + stringFromNumber<span class="o">(</span>180<span class="o">)</span>
</code></pre></div></div>

<p>你可以使用 <code class="highlighter-rouge">dot-notation</code> 来获取文本的宽度（字母数量）。这个会返回一个数字。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"Hello"</span>.length
</code></pre></div></div>

<h3 id="布尔值">布尔值</h3>

<p>布尔变量通常被用来表示逻辑值 —— 是或否。 或者你也可以使用常量（YES, yes, No, no）。</p>

<p>比较的结果都是布尔型的。返回布尔值的表达式的例子：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">true</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3 <span class="o">&gt;</span> 2
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"hello"</span> <span class="o">!=</span> <span class="s2">"world"</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mousePosition.x <span class="o">&gt;=</span> activeRect.x <span class="o">&amp;&amp;</span>
mousePosition.y <span class="o">&gt;=</span> activeRect.y <span class="o">&amp;&amp;</span>
mousePosition.x &lt;<span class="o">=</span> activeRect.x + activeRect.width <span class="o">&amp;&amp;</span>
mousePosition.y &lt;<span class="o">=</span> activeRect.y + activeRect.height
</code></pre></div></div>

<p>你还可以使用三元运算符 <code class="highlighter-rouge">?:</code> 来返回两个值中的一个，具体取决于第一个参数的值。第二个和第三个参数必须是相同类型的（在这个例子中是文本类型）：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>isValid ? <span class="s2">"Valid"</span> : <span class="s2">"Invalid"</span>
</code></pre></div></div>

<h3 id="point点">Point，点</h3>

<p>点，使用 <code class="highlighter-rouge">makePoint(x,y)</code> 函数来创建新的点：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>makePoint<span class="o">(</span>10,20<span class="o">)</span>
</code></pre></div></div>

<p>让我们假设你有个叫 <code class="highlighter-rouge">myPosition</code> 的点变量。并且希望在表达式中使用这个点的 <code class="highlighter-rouge">x</code> 坐标。就可以像这样：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>myPosition.x + 100
</code></pre></div></div>

<p>下面是如何计算 <code class="highlighter-rouge">positionA</code> 和 <code class="highlighter-rouge">positionB</code> 中间的点：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>makePoint<span class="o">((</span>positionA.x + positionB.x<span class="o">)</span> / 2,
          <span class="o">(</span>positionA.y + positionB.y<span class="o">)</span> / 2<span class="o">)</span>
</code></pre></div></div>

<h3 id="size大小">Size，大小</h3>

<p>大小和点类似。它也包含两个数，但是他们是宽和高。它们的用途是表示矩形的大小。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>makeSize<span class="o">(</span>10, 20<span class="o">)</span>
</code></pre></div></div>

<p>假设你已经定义了一个名为 <code class="highlighter-rouge">defaultSize</code> 的 <code class="highlighter-rouge">size</code> 变量和一个数值变量 <code class="highlighter-rouge">zoom</code>。现在你想通过因子 <code class="highlighter-rouge">zoom</code> 放大它的宽度来获得一个新尺寸。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>makeSize<span class="o">(</span>zoom <span class="k">*</span> defaultSize.width, defulatSize.height<span class="o">)</span>
</code></pre></div></div>

<h3 id="rectangle矩形">Rectangle，矩形</h3>

<p><code class="highlighter-rouge">rectangle</code> 变量包含 4 个数字： <code class="highlighter-rouge">x, y, widht, height</code>。有一个用来创建矩形的值的函数叫 <code class="highlighter-rouge">makeRect(x, y, width, height)</code>. 其中 <code class="highlighter-rouge">width</code> 和 <code class="highlighter-rouge">height</code> 表示矩形的大小， <code class="highlighter-rouge">x</code> <code class="highlighter-rouge">y</code> 表示它的原点。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>makeRect<span class="o">(</span>0, 0, 640, 1136<span class="o">)</span>
</code></pre></div></div>

<p>让我们假设你有一个叫 <code class="highlighter-rouge">iPhoneBounds</code> 的矩形 <code class="highlighter-rouge">rect</code>。你不仅可以轻易地获取到每一个值（x, y, width, height），你还可以获得到它的大小和原点。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iphoneBounds.size
</code></pre></div></div>

<p>以下两个表达式是等价的：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iphoneBounds.origin.x + iphoneBounds.size.width
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iphoneBounds.x + iphoneBounds.width
</code></pre></div></div>

<h3 id="颜色">颜色</h3>

<p>颜色由四个数字组件表示：红色、绿色、蓝色和透明。每个组件都取自区间 <code class="highlighter-rouge">'1'</code>。可以用 <code class="highlighter-rouge">makeColor(r, g, b, a)</code> 函数来创建颜色。下面这个表达式返回纯黄色：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>makeColor<span class="o">(</span>1, 1, 0, 1<span class="o">)</span>
</code></pre></div></div>

<p>你在库中定义的颜色也可以被用在表达式里（比如，要根据按钮是否点击来返回两个颜色中的一个）。不过，在表达式里引用颜色（渐变、阴影等库项也一样）的时候要小心。它们的命名比较随意，但是变量的名称是有限制的：</p>

<ul>
  <li>只允许使用英文字母、数字和下划线字符</li>
  <li>只有变量名字的开头使用小写</li>
</ul>

<p>你的颜色名可能会包含空格和符号（比如 ‘Dialog Background Color’）,但是在脚本中引用他们的时候，使用 “净化” 过的形式，就像下面例子中所示：</p>

<p><img src="/images/shot2.png" alt="例子" /></p>

<p>更多例子：</p>

<table>
  <thead>
    <tr>
      <th>原始名字</th>
      <th>“净化”的名字</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>myColor</td>
      <td>myColor</td>
    </tr>
    <tr>
      <td>Bézier Color</td>
      <td>bezierColor</td>
    </tr>
    <tr>
      <td>button-background</td>
      <td>buttonbackground</td>
    </tr>
    <tr>
      <td>button_background</td>
      <td>button_background1</td>
    </tr>
    <tr>
      <td>$a%#^(4)@</td>
      <td>a4</td>
    </tr>
    <tr>
      <td>Extrémité</td>
      <td>extremite</td>
    </tr>
  </tbody>
</table>

<h3 id="渐变">渐变</h3>

<p>要创建一个 <code class="highlighter-rouge">'2 step'</code> 两段渐变，使用 <code class="highlighter-rouge">makeGradient(color1, color2)</code> 函数。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>makeGradient<span class="o">(</span>makeColor<span class="o">(</span>1, 0, 0, 1<span class="o">)</span>,
             makeColor<span class="o">(</span>1, 0, 0, 0<span class="o">))</span>
</code></pre></div></div>

<p>或者，如果你已经有两个颜色了，那么你可以：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>makeGradient<span class="o">(</span>solidRedColor, transparentRedColor<span class="o">)</span>
</code></pre></div></div>

<h3 id="阴影">阴影</h3>

<p>要创建阴影，使用 <code class="highlighter-rouge">makeShadow(color, offsetX, offsetY, blur)</code> 函数。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>makeShadow<span class="o">(</span>solidRedColor, 5, 5, 3<span class="o">)</span>
</code></pre></div></div>

<h2 id="运算符">运算符</h2>

<p>按照优先级排列的运算符：</p>

<table>
  <thead>
    <tr>
      <th>运算</th>
      <th>类型</th>
      <th>结果</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>!b</td>
      <td>boolean</td>
      <td>b 的逻辑非</td>
    </tr>
    <tr>
      <td>x * y</td>
      <td>numbers</td>
      <td>数字 x 和 y 的乘积</td>
    </tr>
    <tr>
      <td>x / y</td>
      <td>numbers</td>
      <td>数 x 和 y 的商</td>
    </tr>
    <tr>
      <td>x % y</td>
      <td>numbers</td>
      <td>进行 x 和 y 除法后的余数; 模数</td>
    </tr>
    <tr>
      <td>m + n</td>
      <td>字符串</td>
      <td>文字 m 和 n 串联</td>
    </tr>
    <tr>
      <td>x + y</td>
      <td>numbers</td>
      <td>x 和 y 的和</td>
    </tr>
    <tr>
      <td>x - y</td>
      <td>numbers</td>
      <td>x 减 y</td>
    </tr>
    <tr>
      <td>x &gt; y</td>
      <td>numbers</td>
      <td>如果 x 大于 y 则为真，否则为假</td>
    </tr>
    <tr>
      <td>x &gt;= y</td>
      <td>numbers</td>
      <td>如果 x 大于等于 y 则为真，否则为假</td>
    </tr>
    <tr>
      <td>x &lt; y</td>
      <td>numbers</td>
      <td>如果 x 小于 y 则为真，否则为假</td>
    </tr>
    <tr>
      <td>x &lt;= y</td>
      <td>numbers</td>
      <td>如果 x 小于等于 y 则为真，否则为假</td>
    </tr>
    <tr>
      <td>a == b</td>
      <td>同类型</td>
      <td>如果 a 等于 b 则为真，否则为假</td>
    </tr>
    <tr>
      <td>a != b</td>
      <td>同类型</td>
      <td>如果 a 不等于 b 则为真，否则为假</td>
    </tr>
    <tr>
      <td>a &amp;&amp; b</td>
      <td>布尔值</td>
      <td>如果 a 和 b 为真则为真，否则为假</td>
    </tr>
    <tr>
      <td>a <code class="highlighter-rouge">||</code> b</td>
      <td>布尔值</td>
      <td>如果 a 和 b 为假则为假，否则为真</td>
    </tr>
    <tr>
      <td>b ? x : y</td>
      <td>布尔值</td>
      <td>如果b为真，那么结果为 x， 否则结果为 y</td>
    </tr>
  </tbody>
</table>

<h2 id="常量">常量</h2>

<ul>
  <li>布尔常量：yes, no, true, false, YES, NO</li>
  <li>数字常量：PI</li>
  <li>颜色常量：MISSING_COLOR</li>
  <li>渐变常量：MISSING_GRADIENT</li>
  <li>阴影常量：MISSING_SHADOW</li>
  <li>图片常量：MISSING_IMAGE</li>
</ul>

<h2 id="基础数学函数">基础数学函数</h2>

<ul>
  <li><code class="highlighter-rouge">floor(x)</code>：返回 x，向下取整</li>
  <li><code class="highlighter-rouge">ceil(x)</code>：返回 x，向上取整</li>
  <li><code class="highlighter-rouge">round(x)</code>：返回 x，四舍五入</li>
  <li><code class="highlighter-rouge">frac(x)</code>：返回 x 的小数部分</li>
  <li><code class="highlighter-rouge">sqrt(x)</code>：返回 x 的平方根</li>
  <li><code class="highlighter-rouge">abs(x)</code>：返回 x 的绝对值</li>
  <li><code class="highlighter-rouge">min(x, y)</code>：返回两个参数中较小的一个</li>
  <li><code class="highlighter-rouge">pow(x, y)</code>：返回 x 的 y 次方</li>
  <li><code class="highlighter-rouge">log(x)</code>：返回一个数字的自然对数</li>
  <li><code class="highlighter-rouge">log2(x)</code>：返回一个数的以2为底的对数</li>
  <li><code class="highlighter-rouge">log10(x)</code>：返回以10为底的对数</li>
</ul>

<h2 id="测角函数">测角函数</h2>

<ul>
  <li><code class="highlighter-rouge">sin(a), cos(a), tan(a)</code>：goniometric functions.Note: parameter a should be in degrees</li>
  <li><code class="highlighter-rouge">atan2(y, x)</code>：arc tangent in degrees of y/x based on the signs of both values to determine the correct quadrant</li>
</ul>

<h2 id="颜色渐变和阴影">颜色、渐变和阴影</h2>

<ul>
  <li><code class="highlighter-rouge">Makeccolor (r，g，b，a)</code>：returns color with components r, g, b, a (red, green, blue, alpha). All parameters should be from interval 0..1</li>
  <li><code class="highlighter-rouge">makeGradient(c1, c2)</code>：returns two step gradient with colors c1 and c2</li>
  <li><code class="highlighter-rouge">makeShadow(color, xOffset, yOffset, blurRadius)</code>：returns shadow</li>
</ul>

<h2 id="其他函数">其他函数</h2>

<ul>
  <li><code class="highlighter-rouge">makePoint(x, y)</code>：returns point</li>
  <li><code class="highlighter-rouge">makeSize(width, height)</code>：returns size</li>
  <li><code class="highlighter-rouge">makeRect(x, y, width, height)</code>：returns rect with position of origin (x, y) and size (width, height)</li>
  <li><code class="highlighter-rouge">stringFromNumber(x)</code>：converts number x to text</li>
</ul>


        
      </div>
    </div>
  </article>
</main>


    <footer id="footer" class="site-footer">
  <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
<div class="copyright">
    
      <p>&copy; 2019 paintcode-documents-in-chinese. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/mmistakes/so-simple-theme" rel="nofollow">So Simple</a>.</p>
    
  </div>
</footer>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>


  </body>

</html>
